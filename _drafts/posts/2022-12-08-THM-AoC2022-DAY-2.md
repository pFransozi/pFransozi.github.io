---
layout: post
title:  THM AoC 2022 DAY TWO
date:   2022-12-08 09:00:00
description: walking through the second day's topics and diving deeper
tags: ["Log-Files", "Log-Analysis"]
category: ["Try-Hack-Me", "THM-AoC-2022", "Log-Analysis"]
---
## Introduction

The second day focuses on log analysis and the goals are:

* **what** log files are and **why** they're useful;
* **what** valuable information log files can contain;
* **where** log files can be found;
* and some **linux commands** to handle with files that are useful with log files;

## Log files and log analysis

Log analysis is an important part of cybersecurity, as it can provide valuable insight into potential security threats, involving collection and analysis of various logs generated by various systems, networks, and applications to detect malicious activities and suspicious patterns. Log files can be used to detect intrusions, malware, malicious user activity, and operational errors. Through log analysis, organizations can identify potential security issues and take corrective measures to address them. Log analysis can also be used to detect patterns of malicious behavior and to track user activity for compliance purposes.

In general, log files record data of an event triggered by an application, such as:

* user logins and logouts;
* system startup and shutdown;
* application usage;
* configuration changes;
* security events;
* network traffic;
* system errors and warnings;
* user actions;
* resource utilization.

And, in general, data recorded is:

* What has happened?
* When has it happened?
* Where has it happened?
* Who did it? Were they successful?
* What is the result of this action?

Another important aspect of this topic is knowing where the files are.

**In Windows**, log files are stored in:

~~~ cmd
%SystemRoot%\System32\Winevt\Logs\
%SystemRoot%\system32\config\
%SystemRoot%\system32\LogFiles\
~~~

Windows OS has an in-built application that allows to access historical records of events that happen. It is an utility that displays detailed information about significant events from the system, security and general applications.

* **System log** contains information about system-wide events, such as when a service starts or stops, or when a driver is installed.

* **Application log** contains information about application events, such as when an application crashes or when an application writes an error to the log.

* **Security log** contains information about security-related events, such as when a user logs on or off, or when a user attempts to access a resource.

* **Setup log** contains information about the setup and configuration of Windows, such as when an application is installed or uninstalled.

Event viewer can be accessed using the command:

~~~ cmd
eventvwr
~~~

**In Linux**, the log files are stored in:

~~~ shell
/var/log
~~~

All file logs in linux are created in that directory by default. Between those files, there are some important ones:

~~~ shell
/var/log/auth.log
/var/log/dpkg.log
/var/log/syslog
/var/log/kern.log
~~~

* **authentication** file contains all authentication (log in). This is usually attempted either remotely or on the system itself (i.e., accessing another user after logging in).
Example: failed password for root from 192.168.1.35 port 22 ssh2.

* **package management** contains all events related to package management on the system. When installing a new software (a package), this is logged in this file. This is useful for debugging or reverting changes in case this installation causes unintended behaviour on the system.
Example: 2022-06-03 21:45:59 installed neofetch.

* **syslog** contains all events related to things happening in the system's background. For example, crontabs executing, services starting and stopping, or other automatic behaviours such as log rotation. This file can help debug problems.
Example: 2022-06-03 13:33:7 Finished Daily apt download activities..

* **kernel** contains all events related to kernel events on the system. For example, changes to the kernel, or output from devices such as networking equipment or physical devices such as USB devices.
Example: 2022-06-03 10:10:01 Firewalling registered

### General application

~~~ shell
/var/log/
/var/log/apache2/
/var/log/nginx/
/var/log/mysql.log
/var/log/samba/
/var/log/maillog
/var/log/vsftpd.log
~~~

~~~ cmd
%SystemRoot%\system32\LogFiles\HTTPERR
%SystemRoot%\system32\LogFiles\RDP
%SystemRoot%\system32\LogFiles\DNS
%SystemRoot%\system32\LogFiles\DHCP
%SystemRoot%\system32\LogFiles\Kerberos
%SystemRoot%\system32\LogFiles\Firewall
~~~

### SIEM

SIEM stands for Security Information and Event Management. It is a type of software used to collect, store, analyze, and report on log data from multiple sources. SIEM helps organizations to monitor their IT environment for security threats, detect suspicious activity, and take corrective action. It can also be used to track user activity for compliance purposes. The two most common applications are: Splunk and ELK Stack.

In unix-based OS, there are very important tools to handle text files and for that log files as well. Some examples are:

* tail;
* head;
* less;
* grep, egrep, fgrep;
* find;
* locate;
* awk;
* touch;
* echo;

## References

### THM resources

[Splunk 101](https://tryhackme.com/room/splunk101){:target="_blank"}.

[Splunk 201](https://tryhackme.com/room/splunk201){:target="_blank"}.

[Intro SIEM](https://tryhackme.com/room/introtosiem){:target="_blank"}.

[Linux Fundamental 1](https://tryhackme.com/room/linuxfundamentalspart1){:target="_blank"}.

[Linux Fundamental 2](https://tryhackme.com/room/linuxfundamentalspart3){:target="_blank"}.

[Linux Fundamental 3](https://tryhackme.com/room/linuxfundamentalspart2){:target="_blank"}.

[Linux Modules](https://tryhackme.com/room/linuxmodules){:target="_blank"}.

### others resources

[Splunk](https://www.splunk.com/)

[ELK Stack](https://www.elastic.co/what-is/elk-stack)
