---
layout: post
title:  THM AoC 2022 DAY ONE
date:   2022-12-06 09:00:00
description: walking through the first day's topics and diving deeper
tags: ["nist-csf", "iso-27001", "iso-27002", "mitre-att&ck", "cyber-kill-chain", "unified-kill-chain", "security-framework"]
category: ["try-hack-me", "thm-aoc-2022"]
---
## Introduction

TryHackMe's first day of Advent of Cyber 2022 is here, and we have to face theory about security frameworks, such as NIST Cybersecurity Framework, ISO 27001 e 27002, MITRE ATT&CK, Cyber Kill Chain, Unified Kill Chain. The latter can be described as the unification of the ATT&CK and Kill Chain frameworks, and it is the focus of the first day.

## Security Frameworks

### what is a security framework?

Let's divide the expression "security framework", and understand the word "framework". Framework is widely used in different areas, but semantically there is one thing in common, which is a basic structure underlying another one, supporting it in an essential way.

Thus, a security framework is a basic structure that support the security operation, defining policies, control objectives, standards, controls, procedures, guidelines, baselines. In general guidelines and baselines are discretionary, which means there is a margin for judgment. On the other hand, policies, control objectives, standards, controls, procedures are mandatory, which means no margin for judgment.

Then, security framework is a set of documents that define a basic structure which underlie all the security processes, in a way to identify and manage the risks and the weaknesses. In general, modern security frameworks are based on risk- and awareness-based approaches.

### why we have to know and follow frameworks?

We have to know and follow security frameworks because they reduce or even remove guesswork to the extent that they include processes and structures in a strategic plan that involves the security objectives.

Follow a security framework is not an one-time activity, but instead it is a set of long-term-ongoing activities. Security framework is not an activity just when a security incident occurs, but it has to be present on the scene before, during and after.

Additionally, as a consequence, it will help achieve commercial and government regulatory requirements.

### and more

Notwithstanding the technical and business side, frameworks provide a common language between the stakeholders, helping communication and understanding.

Before starting, a hint: the content below is just a summary, it's highly recommended study one of them or all frameworks for a grounded understanding.

### nist cybersecurity framework

CSF is a risk-based framework, focusing on manage cybersecurity risk. It is composed of three parts:

* **core**: it presents industry standards, guidelines, and practices. The Core consists of five concurrent and continuous functions: identity, protect, detect, respond, recover.
* **implementation tiers**: they provide context on how an organization views cybersecurity risk and the processes in place to manage that risk. Context means the degree to which an organization's cybersecurity risk management practices exhibit the characteristics defined in the Framework. The degree is defined as: partial (T1) to adaptive (T4), which means a progression from informal to approaches that are agile and risk-informed. During this phase, the organization must consider the current state-of-the-art, which includes: its current risk management practices, threat environment, legal and regulatory requirements, business/mission objectives, and organizational constraints.
* **profiles**: it is the alignment, based on the selected framework categories and subcategories, of standards, guidelines, and practices to the framework core in a particular implementation scenario. A profile is developed based on business/mission drivers and a risk assessment, determining which categories and subcategories are most important in a way to address the organization's risks. Profiles can be used to support prioritization and measurement of progress toward the target profile, to conduct self-assessments and to communicate.

#### Core

Core is defined by five functions, which arrange basic cybersecurity activities, organizing information, enabling risk management decisions, addressing threats, and improving by learning from previous activities. They are aligned with existing methodologies for incident management
and help show the impact of investments in cybersecurity. Each function is described by:

* **categories** subdivide functions into groups of cybersecurity outcomes closely tied to programmatic needs and particular activities, such as "asset management", "awareness and training", "security continuous monitoring", "analysis", "recovery planning".
* **subcategories** subdivide categories into specific outcomes of technical or management activities such as "data-at-rest is protected", "notifications from detection systems are investigated"
* **information references** are specific standards, guidelines, practices that illustrate a method to achieve the outcomes associated with each subcategory.

And the five functions are:

* **identity**: it is related essentially to understanding and awareness about the systems, people, assets, data, and capabilities, with the risks related to them. Examples are: asset management, business environment, governance, risk assessment, and risk management strategy.
* **protect**: it is related essentially to ensuring delivery of critical services, limiting or containing the impact of a potential cybersecurity event. Examples are: identity management and access control, awareness and training, data security, information protection processes and procedures, maintenance, and protective technology.
* **detect**: it is related essentially to identifying the occurrence of a cybersecurity event. Examples are: anomalies and events, security continuous monitoring, and detection processes.
* **respond**: it is related essentially to taking action regarding a detected cybersecurity incident. Examples are: response planning, communications, analysis, mitigation; and improvements.
* **recover**: it is related essentially to maintaining plans for resilience and to restoring any capabilities or services that were impaired due to a cybersecurity incident.

Before ending or overview, let's describe the steps to create a CSF program. NIST's document ranks seven steps, such as:

1. **prioritize and scope**: to identify business objectives and high-level organizational priorities; to make strategic decisions regarding cybersecurity implementations and to determine the scope of systems and assets that support the selected business line or process; to adapt the framework to support different business lines or processes, which may have different business needs and risk tolerance.
2. **orient**: once prioritize and scope has been determined, to identity related systems and assets, regulatory requirements, and overall risk approach; to consult sources to identity threats and vulnerabilities applicable to those systems and assets.
3. **create a current profile**: then, to develop a current profile, which indicates categories and subcategories from the Framework Core that are currently being achieved.
4. **conduct a risk assessment**: to analyze the operational environment in order to discern the likelihood of a cybersecurity event and the impact that the event could have on the organization; to identify emerging risks and use cyber threat information from internal and external sources to gain a better understanding of the likelihood and impact of cybersecurity events.
5. **create a target profile**: to creates a Target Profile that focuses on the assessment of the Framework Categories and Subcategories describing the organizationâ€™s desired cybersecurity outcomes; to develop an additional Categories and Subcategories to account for unique organizational risks; to consider influences and requirements of external stakeholders such as sector entities, customers, and business partners when creating a Target Profile. The Target Profile should appropriately reflect criteria within the target Implementation Tier.
6. **determine, analyze, and prioritize gaps**: to compare the Current Profile and the Target Profile to determine gaps; next, to create a prioritized action plan to address gaps, reflecting mission drivers, costs and benefits, and risks, to achieve the outcomes in the Target Profile; to determine resources, including funding and workforce, necessary to address the gaps. Using Profiles in this manner encourages the organization to make informed decisions about cybersecurity activities, supports risk management, and enables the organization to perform cost-effective, targeted improvements.
7. **implement action plan**: to determine which actions to take to address the gaps, if any, identified in the previous step and then adjusts its current cybersecurity practices in order to achieve the Target Profile. For further guidance, to determine which standards, guidelines, and practices, including those that are sector specific, work best for their needs.

It is an ongoing process and an organization repeats the steps as needed to continuously assess and improve its cybersecurity.

### iso 27001 and iso 27002

The first day of Advent of Cyber 2022 of TryHackMe mentions briefly ISO 27001 and 27002, which are standards for cybersecurity and outline the requirements and procedures for creating, implementing and managing an information security management system (ISMS).

ISO 27001:2022, the latest version, is a specification for an information security management system (ISMS), which means a framework of policies and procedures that includes all legal, physical and technical controls involved in an information risk management processes.

> Provide a model for establishing, implementing, operating, monitoring, reviewing, maintaining and improving an information security management system.

It's technology-neutral, risk-based-approach, helping organizations manage their information security by addressing people, processes, and technology. For that, it defines six planning process, which are:

1. Define a security policy;
2. Define the scope of the ISMS;
3. Conduct a risk assessment;
4. Manage identified risks;
5. Select control objectives and controls to be implemented;
6. Prepare a statement of applicability.

It does not mandate specific information security controls, but it provides a checklist of controls that should be considered in the accompanying code of practice, ISO/IEC 27002:2005.

ISO 27002:2022, the latest version, provides best practice on information security control for use by those responsible for initiating, implementing or maintaining ISMS in the context of the CIA triad.

> The preservation of confidentiality (ensuring that information is accessible only to those authorized to have access), integrity (safeguarding the accuracy and completeness of information and processing methods) and availability (ensuring that authorized users have access to information and associated assets when required).

ISO 27002 contains 12 main sections:

1. Risk assessment;
2. Security policy;
3. Organization of information security;
4. Asset management;
5. Human resources security;
6. Physical and environmental security;
7. Communications and operations management;
8. Access control;
9. Information systems acquisition, development and maintenance;
10. Information security incident management;
11. Business continuity management;
12. Compliance.

### mitre att&ck framework

ATT&CK is a huge behavioral model, which is defined by:

* **tactics**, denoting short-term, tactical adversary goals during an attack;
* **techniques**, describing the means by which adversaries achieve tactical goals;
* **Sub-techniques**, describing more specific means by which adversaries achieve tactical
goals at a lower level than techniques; and
* **documented** adversary usage of techniques, their procedures, and other metadata.

Currently, it has 14 tactics:

1. **reconnaissance**, which means that the attacker is gathering information, in an active or passive way, that can be used to support targeting, such as:
   * active scanning;
   * scanning IP blocks;
   * vulnerability scanning
   * wordlist scanning;
   * gather victim host information:
      hardware;
      software;
      firmware;
      client configuration;
   * gather victim identity information:
      * credentials;
      * email address;
      * employee names;
   * gather victim network information:
      * domain properties;
      * DNS;
      * network trust dependencies;
      * network topology;
      * IP addresses;
      * network security appliances;
   * gather victim org information:
      * determine physical locations;
      * business relationships;
      * identity business tempo;
      * identity roles;
   * phishing for information:
      * spearphishing service;
      * spearphishing attachment;
      * spearphishing link;
   * search closed sources:
      * threat intel vendors;
      * purchase technical data;
   * search open technical databases:
      * dns/passive dns;
      * whois;
      * digital certificates;
      * cdns;
      * scan databases;
   * search open websites/domains:
      * Social Media;
      * Search Engines;
      * Code Repositories;
   * Search Victim-Owned Websites
2. **resource development**, which means that attacker is trying to establish resources that can be used to support operations, such as:
   * acquire infrastructure:
      * domains;
      * dns server;
      * virtual private server;
      * server;
      * botnet;
      * web services;
      * serverless;
   * compromise accounts:
      * social media accounts;
      * email accounts;
      * cloud accounts;
   * compromise infrastructure:
      * domains;
      * dns server;
      * virtual private server;
      * server;
      * botnet;
      * web services;
      * serverless;
   * develop capabilities:
      * malware;
      * code signing certificates;
      * digital certificates;
      * exploits;
   * establish accounts:
      * social media accounts;
      * email accounts;
      * cloud accounts;
   * obtain capabilities:
      * malware;
      * tool;
      * code signing certificates;
      * digital certificates;
      * exploits;
      * vulnerabilities;
   * stage capabilities:
      * upload malware;
      * Upload tool;
      * install digital certificate;
      * drive-by target;
      * link target;
      * seo poisoning;
3. **initial access**, which means various entry vectors to gain the first foothold into the network, such as:
   * drive-by compromise;
   * exploit public-facing application;
   * external remote services;
   * hardware additions;
   * phishing:
      * spearphishing attachment;
      * spearphishing link;
      * spearphishing via service;
   * replication through removable media;
   * supply chain compromise:
      * compromise software dependencies and development tools;
      * compromise software supply chain;
      * compromise hardware supply chain;
   * trusted relationship;
   * valid accounts:
      * default accounts;
      * domain accounts;
      * local accounts;
      * cloud accounts;
4. **execution**, which means adversary-controlled code running on a local or remote system, aiming broader goals, like exploring a network or stealing data, such as:
   * command and scripting interpreter:
      * powershell;
      * applescript;
      * windows command shell;
      * unix shell;
      * visual basic;
      * python;
      * javascript;
      * network device cli;
   * container administration command;
   * deploy container;
   * exploitation for client execution;
   * inter-process communication:
      * component object model;
      * dynamic data exchange;
      * xpc services;
   * native api
   * scheduled task/job:
      * at;
      * cron;
      * scheduled task;
      * systemd timers;
      * container orchestration job;
   * serverless execution
   * shared modules
   * software deployment tools
   * system services:
      * launchctl;
      * service execution;
   * user execution:
      * malicious link;
      * malicious file;
      * malicious image;
   * windows management instrumentation
5. **persistence**, which consists fo techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access, such as:
   * account manipulation:
      * additional cloud credentials;
      * additional email delegate permissions;
      * additional cloud roles;
      * ssh authorized keys;
      * device registration;
   * bits jobs;
   * boot or logon autostart execution:
      * registry run keys / startup folder;
      * authentication package;
      * time providers;
      * winlogon helper dll;
      * security support provider;
      * kernel modules and extensions;
      * re-opened applications;
      * lsass driver;
      * shortcut modification;
      * port monitors;
      * print processors;
      * xdg autostart entries;
      * active setup;
      * login items;
   * boot or logon initialization scripts:
      * logon script (windows);
      * login hook;
      * network logon script;
      * rc scripts;
      * startup items;
   * browser extensions;
   * compromise client software binary;
   * create account:
      * local account;
      * domain account;
      * cloud account;
   * create or modify system process:
      * launch agent;
      * systemd service;
      * windows service;
      * launch daemon;
   * event triggered execution:
      * change default file association;
      * screensaver;
      * windows management instrumentation event subscription;
      * unix shell configuration modification;
      * trap;
      * lc_load_dylib addition;
      * netsh helper dll;
      * accessibility features;
      * appCert dlls;
      * appInit dlls;
      * application shimming;
      * image file execution options injection;
      * powerShell profile;
      * emond;
      * component object model hijacking;
      * installer packages;
   * external remote services;
   * hijack execution flow:
      * dll search order hijacking;
      * dll side-loading;
      * dylib hijacking;
      * executable installer file permissions weakness;
      * dynamic linker hijacking;
      * path interception by path environment variable;
      * path interception by search order hijacking;
      * path interception by unquoted path;
      * services file permissions weakness;
      * services registry permissions weakness;
      * cor_profiles;
      * kernelcallbacktable;
   * implant internal image;
   * modify authentication process:
      * domain controller authentication;
      * password filter dll;
      * pluggable authentication modules;
      * network device authentication;
      * reversible encryption;
      * multi-dactor authentication;
      * hybrid identity;
   * office application startup:
      * office template macros;
      * office test;
      * outlook forms;
      * outlook home page;
      * outlook rules;
      * add-ins;
   * pre-os boot:
      * system firmware;
      * component Firmware;
      * bootkit;
      * rommonkit;
      * tftp boot;
   * scheduled task/job:
      * at;
      * cron;
      * scheduled task;
      * systemd timers;
      * container orchestration job;
   * server software component:
      * sql stored procedures;
      * transport agent;
      * web shell;
      * iis components;
      * terminal services dll;
   * traffic signaling:
      * port knocking;
      * socket filters;
   * valid accounts:
      * default accounts;
      * domain accounts;
      * local accounts;
      * cloud accounts;
6. **privilege escalation**, which means techniques that are used to gain higher-level permissions on a system or network, such as:
   * abuse elevation control mechanism:
      * setuid and setgid;
      * bypass user account control;
      * sudo and sudo caching;
      * elevated execution with prompt;
   * access token manipulation:
      * token impersonation/theft;
      * create process with token;
      * make and impersonate token;
      * parent pid spoofing;
      * sid-history injection;
   * boot or logon autostart execution:
      * registry run keys / startup folder;
      * authentication package;
      * time providers;
      * winlogon helper dll;
      * security support provider;
      * kernel modules and extensions;
      * re-opened applications;
      * lsass driver;
      * shortcut modification;
      * port monitors;
      * print processors;
      * xdg autostart entries;
      * active setup;
      * login items;
   * boot or logon initialization scripts:
      * logon script (windows);
      * login hook;
      * network logon script;
      * rc scripts;
      * startup items;
   * create or modify system process:
      * Launch Agent;
      * Systemd Service;
      * Windows Service;
      * Launch Daemon;
   * domain policy modification:
      * group policy modification;
      * domain trust modification;
   * escape to host:
   * event triggered execution:
      * change default file association;
      * screensaver;
      * windows management instrumentation event subscription;
      * unix shell configuration modification;
      * trap;
      * lc_load_dylib addition;
      * netsh helper dll;
      * accessibility features;
      * appcert dlls;
      * appinit dlls;
      * application shimming;
      * image file execution options injection;
      * powershell profile;
      * emond;
      * component object model hijacking;
      * installer packages;
   * exploitation for privilege escalation;
   * hijack execution flow:
      * dll search order hijacking;
      * dll side-loading;
      * dylib hijacking;
      * executable installer file permissions weakness;
      * dynamic linker hijacking;
      * path interception by path environment variable;
      * path interception by search order hijacking;
      * path interception by unquoted path;
      * services file permissions weakness;
      * services registry permissions weakness;
      * cor_profiler;
      * kernelcallbacktable;
   * process injection:
      * dynamic-link library injection;
      * portable executable injection;
      * thread execution hijacking;
      * asynchronous procedure call;
      * thread local storage;
      * ptrace system calls;
      * proc memory;
      * extra window memory injection;
      * process hollowing;
      * process doppelgÃ¤nging;
      * vdso hijacking;
      * listplanting;
   * scheduled rask/job:
      * at;
      * cron;
      * scheduled task;
      * systemd timers;
      * container orchestration job;
   * valid accounts:
      * default accounts;
      * domain accounts;
      * local accounts;
      * cloud accounts;
7. **defense evasion**, which means techniques used to avoid detection throughout their compromise, such as:
   * abuse elevation control mechanism:
      * setuid and setgid;
      * bypass user account control;
      * sudo and sudo caching;
      * elevated execution with prompt;
   * access token manipulation:
      * token impersonation/theft;
      * create process with token;
      * make and impersonate token;
      * parent pid spoofing;
      * sid-history injection;
   * bits jobs;
   * build image on host;
   * debugger evasion;
   * deobfuscate/decode files or information;
   * deploy container;
   * direct volume access;
   * domain policy modification:
      * group policy modification;
      * domain trust modification;
   * execution guardrails:
      * environmental keying;
   * exploitation for defense evasion;
   * file and directory permissions modification:
      * windows file and directory permissions modification;
      * linux and mac file and directory permissions modification;
   * hide artifacts:
      * hidden files and directories;
      * hidden users;
      * hidden window;
      * ntfs file attributes;
      * hidden file system;
      * run virtual instance;
      * vba stomping;
      * email hiding rules;
      * resource forking;
      * process argument spoofing;
   * hijack execution flow:
       * dll search order hijacking;
       * dll side-loading;
       * dylib hijacking;
       * executable installer file permissions weakness;
       * dynamic linker hijacking;
       * path interception by path environment variable;
       * path interception by search order hijacking;
       * path interception by unquoted path;
       * services file permissions weakness;
       * services registry permissions weakness;
       * cor_profiler;
       * kernelcallbacktable;
   * impair defenses:
       * disable or modify tools;
       * disable windows event logging;
       * impair command history logging;
       * disable or modify system firewall;
       * indicator blocking;
       * disable or modify cloud firewall;
       * disable cloud logs;
       * safe mode boot;
       * downgrade attack;
   * indicator removal:
      * clear windows event logs;
      * clear linux or mac system logs;
      * clear command history;
      * file deletion;
      * network share connection removal;
      * timestomp;
      * clear network connection history and configurations;
      * clear mailbox data;
      * clear persistence;
   * indirect command execution;
   * masquerading:
       * invalid code signature;
       * right-to-left wverride;
       * rename system utilities;
       * masquerade task or service;
       * match legitimate name or location;
       * space after filename;
       * double file extension;
   * modify authentication process:
       * domain controller authentication
       * password filter dll;
       * pluggable authentication modules;
       * network device authentication;
       * reversible encryption;
       * multi-factor authentication;
       * hybrid identity;
   * modify cloud compute infrastructure:
       * create snapshot;
       * create cloud instance;
       * delete cloud instance;
       * revert cloud instance;
   * modify registry;
   * modify system image:
       * patch system image;
       * downgrade system image;
   * network boundary bridging:
      * network address translation traversal;
   * obfuscated files or information:
       * binary padding;
       * software packing;
       * steganography;
       * compile after delivery;
       * indicator removal from tools;
       * html smuggling;
       * dynamic api resolution;
       * stripped payloads;
       * embedded payloads;
   * plist file modification;
   * pre-os boot:
       * system firmware;
       * component firmware;
       * bootkit;
       * rommonkit;
       * tftp boot;
   * process injection:
       * dynamic-link library injection;
       * portable executable injection;
       * thread execution hijacking;
       * asynchronous procedure call;
       * thread local storage;
       * ptrace system calls;
       * proc memory;
       * extra window memory injection;
       * process hollowing;
       * process doppelgÃ¤nging;
       * vdso hijacking;
       * listplanting;
   * reflective code loading;
   * rogue domain controller;
   * rootkit;
   * subvert trust controls:
       * gatekeeper bypass;
       * code signing;
       * sip and trust provider hijacking;
       * install root certificate;
       * mark-of-the-web bypass;
       * code signing policy modification;
   * system binary proxy execution:
       * compiled html file;
       * control panel;
       * cmstp;
       * installutil;
       * mshta;
       * msiexec;
       * odbcconf;
       * regsvcs/regasm;
       * regsvr32;
       * rundll32;
       * verclsid;
       * mavinject;
       * mmc;
   * system script proxy execution:
      * pubprn;
   * template injection;
   * traffic signaling:
      * port knocking;
      * socket filters;
   * trusted developer utilities proxy execution:
      * msbuild;
   * unused/unsupported cloud regions;
   * use alternate authentication material:
      * application access token;
      * pass the hash;
      * pass the ticket;
      * web session cookie;
   * valid accounts:
      * default accounts;
      * domain accounts;
      * local accounts;
      * cloud accounts;
   * virtualization/sandbox evasion:
      * system checks;
      * user activity based checks;
      * time based evasion;
   * weaken encryption:
      * reduce key space;
      * disable crypto hardware;
   * xsl script processing;
8. **credential access**, which means techniques that are used to steal credentials like account names and passwords, such as:
   * adversary-in-the-middle:
      * llmnr/nbt-ns
      * arp cache poisoning;
      * dhcp spoofing;
   * brute force:
      * password guessing;
      * password cracking;
      * password spraying;
      * credential stuffing;
   * credentials from password stores:
      * keychain
      * securityd memory;
      * credentials from web browsers;
      * windows credential manager;
      * password managers;
   * exploitation for credential access;
   * forced authentication;
   * forge web credentials;
      * web cookies;
      * saml tokens;
   * input capture:
      * keylogging;
      * gui input capture;
      * web portal capture;
      * credential api hooking;
   * modify authentication process:
      * domain controller authentication;
      * password filter dll;
      * pluggable authentication modules;
      * network device authentication;
      * reversible encryption;
      * multi-factor authentication;
      * hybrid identity;
   * multi-factor authentication interception;
   * multi-factor authentication request generation;
   * network sniffing;
   * os credential dumping:
      * lsass memory;
      * security account manager;
      * ntds;
      * lsa secrets;
      * cached domain credentials;
      * dcsync;
      * proc filesystem;
      * /etc/passwd and /etc/shadow;
   * steal application access token;
   * steal or forge authentication certificates;
   * steal or forge kerberos tickets:
      * golden ticket;
      * silver ticket;
      * kerberoasting;
      * as-rep roasting;
   * steal web session cookie;
   * unsecured credentials:
      * credentials in files;
      * credentials in registry;
      * bash history;
      * private keys;
      * cloud instance metadata api;
      * group policy preferences;
      * container api;
9. **discovery**, which means techniques that can be used to gain knowledge about the system and internal network, such as:
   * account discovery:
      * local account;
      * domain account;
      * email account;
      * cloud account;
   * application window discovery;
   * browser bookmark discovery;
   * cloud infrastructure discovery;
   * cloud service dashboard;
   * cloud service discovery;
   * cloud storage object discovery;
   * container and resource discovery;
   * debugger evasion;
   * domain trust discovery;
   * file and directory discovery;
   * group policy discovery;
   * network service discovery;
   * network share discovery;
   * network sniffing;
   * password policy discovery;
   * peripheral device discovery;
   * permission groups discovery:
      * local groups;
      * domain groups;
      * cloud groups;
   * process discovery;
   * query registry;
   * remote system discovery;
   * software discovery:
      * security software discovery;
   * system information discovery;
   * system location discovery:
      * system language discovery;
   * system network configuration discovery;
   * internet connection discovery;
   * system network connections discovery;
   * system owner/user discovery;
   * system service discovery;
   * system time discovery;
   * virtualization/sandbox evasion:
      * system checks;
      * user activity based checks;
      * time based evasion;
10. **lateral movement**, which means techniques that can be used to enter and control remote systems on a network, such as:
    * exploitation of remote services;
    * internal spearphishing;
    * lateral tool transfer
    * remote service session hijacking:
       * ssh hijacking;
       * rdp hijacking;
    * remote services:
       * remote desktop protocol;
       * smb/windows admin shares;
       * distributed component object model;
       * ssh;
       * vnc;
       * windows remote management;
    * replication through removable media;
    * software deployment tools;
    * taint shared content;
    * use alternate authentication material:
      * application access token;
      * pass the hash;
      * pass the ticket;
      * web session cookie;
11. **collection**, which means techniques that are used to gather information, such as:
    * adversary-in-the-middle:
      * llmnr/nbt-ns;
      * arp cache poisoning;
      * dhcp spoofing;
    * archive collected data:
      * archive via utility;
      * archive via library;
      * archive via custom method;
    * audio capture;
    * automated collection;
    * browser session hijacking;
    * clipboard data;
    * data from cloud storage;
    * data from configuration repository:
      * snmp (mib dump);
      * network device configuration dump;
    * data from information repositories:
      * confluence;
      * sharepoint;
      * code repositories;
    * data from local system;
    * data from network shared drive;
    * data from removable media;
    * data staged:
      * local data staging;
      * remote data staging;
    * email collection:
      * local email collection;
      * remote email collection;
      * email forwarding rule;
    * input capture:
      * keylogging;
      * gui input capture;
      * *web portal capture;
      * credential api hooking;
    * screen capture;
    * video capture;
12. **command and control**, which means techniques that can be used to communicate with systems under attacker's control within a victim network, such as;
    * application layer protocol;
      * web protocols;
      * file transfer protocols;
      * mail protocols;
      * dns;
    * communication through removable media;
    * data encoding:
      * standard encoding;
      * non-standard encoding;
    * data obfuscation:
      * junk data;
      * steganography;
      * protocol impersonation;
    * dynamic resolution:
      * fast flux dns;
      * domain generation algorithms;
      * dns calculation;
    * encrypted channel:
      * symmetric cryptography;
      * asymmetric cryptography;
    * fallback channels;
    * ingress tool transfer;
    * multi-stage channels;
    * non-application layer protocol;
    * non-standard port;
    * protocol tunneling;
    * proxy:
      * internal proxy;
      * external proxy;
      * multi-hop proxy;
      * domain fronting;
    * remote access software;
    * traffic signaling:
      * port knocking;
      * socket filters;
    * web service:
      * dead drop resolver;
      * bidirectional communication;
      * one-way communication;
13. **exfiltration**, which means techniques that can be used to steal data from victim network, such as:
    * automated exfiltration:
      * traffic duplication;
    * data transfer size limits;
    * exfiltration over alternative protocol:
      * exfiltration over symmetric encrypted non-c2 protocol;
      * exfiltration over asymmetric encrypted non-c2 protocol;
      * exfiltration over unencrypted non-c2 protocol;
    * exfiltration over c2 channel;
    * exfiltration over other network medium;
    * exfiltration over bluetooth;
    * exfiltration over physical medium:
      * exfiltration over usb;
    * exfiltration over web service:
      * exfiltration to code repository;
      * exfiltration to cloud storage;
    * scheduled transfer;
    * transfer data to cloud account;
14. **impact**, which means techniques that can be used to disrupt availability or compromise integrity by manipulating business and operational processes, such as:
    * account access removal;
    * data destruction;
    * data manipulation:
      * stored data manipulation;
      * transmitted data manipulation;
      * runtime data manipulation;
    * defacement:
      * internal defacement;
      * external defacement;
    * disk wipe:
      * disk content wipe;
      * disk structure wipe;
    * endpoint denial of service:
      * os exhaustion flood;
      * service exhaustion flood;
      * application exhaustion flood;
      * application or system exploitation;
    * firmware corruption:
    * inhibit system recovery;
    * network denial of service:
      * direct network flood;
      * reflection amplification;
    * resource hijacking;
    * service stop;
    * system shutdown/reboot;

The MITRE ATT&CK framework provides a comprehensive taxonomy to help security practitioners better understand and defend against attack techniques used by adversaries. It's attack matrices, adversary tactics and techniques, and core mitigations provide a comprehensive overview of the current state of cyber-attacks and defenses, making it an invaluable asset for security practitioners and a valuable resource for those just getting started.

### cyber kill chain

It describes the structure of an attack and consists of target identification, decision and order to attack the target, and finally, target destruction. The cyber kill chain describes the stages commonly followed by cyberattacks and security defenders can use the framework as part of intelligence-driven defense.

1. **reconnaissance**: on the one hand, *adversary is* in the planning phase of its operation, conducting researches to understanding which targets will enable them to meet its objectives. On the other hand, *defender is* trying to detect recon, even though it is a very difficult task, but it can reveal the intent of the adversaries.
2. **weaponizations**: *adversary*, on the one hand, is in the preparation and staging phase of its operation, in general, using automated tools, mixing malware and exploit into a deliverable payload. On the other hand, it is an essential phase *for defender* to understand by analyzing malware artifacts.
3. **delivery**: on the one hand, *adversary* convey the malware to the target, and officially it is launched its operation. Adversaries often use malware to gain access to a target system and launch malicious operations. Once the malware is in place, it can be used to gain access to sensitive information, execute commands, and even take control of the system. It is important for security professionals to be aware of the different types of malware that adversaries may use in order to better defend against their attacks. Because of that, on the other hand, this is the first and most important opportunity for *defender* to block the malicious operation.
4. **exploitation**: *adversary*, on the one hand, exploit a vulnerability to gain access, and it is not necessary that that exploited vulnerability has been sent to the victim in the delivery phase. In some cases, an attacker may be able to exploit a vulnerability without convey any malicious code to the target, skipping the delivery phase and jumping directly to the exploitation phase. On the other hand, *defender* must identify, patch, and monitor for any suspicious activity that may indicate an attempted exploit. Additionally, defenders should implement security controls to prevent or detect any potential exploits.
5. **installation**: *adversary*, on the one hand, installs a persistent backdoor or implant in the victim environment to maintain access for an extended period of time. Adversary may also use privilege escalation or exploiting vulnerabilities in the system services. On the other hand, adversary can use endpoint instrumentation to detect and log installation activity. Analyze installation phase during malware analysis to create new endpoint mitigations.
6. **command & control**: *Adversary* can manipulate remotely the victim through a channel opened by the malware. On the other hand, *defender* have the last chance to block the operation, by interrupting the C2 channel.
7. **actions on objectives**: Adversary accomplishes the intrusion procedure, and what happens next depends on the objectives of the adversary. The longer an adversary has CKC7
access, the greater the impact. Defenders must detect this stage as quickly as possible by using forensic evidence â€“ including network packet captures, for damage assessment.

The Cyber Kill Chain is a framework used by security professionals to better understand how attackers gain access to systems, maintain access, and achieve their objectives. Understanding this framework is essential for security practitioners, as it provides a comprehensive overview of how adversaries operate and how to best defend against their attacks. It can also be a valuable resource for entry-level security professionals, as it provides a foundation for understanding the various stages of an attack.

### unified kill chain

The Unified Kill Chain can be described as the unification of the MITRE ATT&CK and Cyber Kill Chain frameworks. The Unified Kill Chain describes 18 phases of attack based on Tactics, Techniques and Procedures (TTPs). The individual phases can be combined to form overarching goals, such as gaining an initial foothold in a targeted network, navigating through the network to expand access and performing actions on critical assets.

The Unified Kill Chain (UKC) is divided into three phases:

* **initial access**;
* **execution**;
* **exfiltration**;

Each phase is further **divided into stages**, which can be used to better understand the various steps of an attack.

The Initial Access phase includes the stages of Reconnaissance, Delivery, and Exploitation. During Reconnaissance, attackers gather information about the target system. During Delivery, attackers deliver malicious code or data to the target system. During Exploitation, attackers take advantage of vulnerabilities in the system in order to gain access.

The Execution phase includes the stages of Installation, Command & Control, and Actions on Objectives. During Installation, attackers install malware on the target system. During Command & Control, attackers use the malware to remotely control the system. During Actions on Objectives, attackers use the malware to achieve their goals.

The Exfiltration phase includes the stages of Denial of Service and Data Destruction. During Denial of Service, attackers use the malware to disable or disrupt the system. During Data Destruction, attackers use the malware to delete or modify data.

## Conclusion

Cybersecurity frameworks are essential for organizations that are looking to protect their systems and data from the ever-evolving threats of cyber-attacks. By understanding these frameworks, organizations can develop a comprehensive security strategy that aligns with their business objectives and helps them to mitigate security risks. Furthermore, cybersecurity frameworks can help organizations to identify and address potential security vulnerabilities and to ensure that they are compliant with relevant regulatory requirements. As an entry-level cybersecurity professional, understanding the various cybersecurity frameworks is essential to be successful in the field. Not only do these frameworks provide an overview of the best practices for protecting systems and data, but they also provide a way to identify potential security vulnerabilities and address them. Therefore, it is important for organizations and entry-level cybersecurity professionals to understand and implement cybersecurity frameworks in order to remain secure and resilient.

## References

### THM references

[THM Learning path about Cyber Defence Frameworks](https://tryhackme.com/module/cyber-defence-frameworks){:target="_blank"}.

[THM Room about Unified Kill Chain](https://tryhackme.com/room/unifiedkillchain){:target="_blank"}.

[THM Room about Cyber Kill Chain](https://tryhackme.com/room/cyberkillchainzmt){:target="_blank"}.

[THM Room about MITRE](https://tryhackme.com/room/mitre){:target="_blank"}.

[THM Room about MITRE](https://tryhackme.com/room/mitre){:target="_blank"}.

### Other references

[NIST Cybersecurity Framework](https://www.nist.gov/cyberframework){:target="_blank"}.

[OAS AWS NIST CSF](https://www.oas.org/en/sms/cicte/docs/OAS-AWS-NIST-Cybersecurity-Framework(CSF)-ENG.pdf){:target="_blank"}.

[ATTACK's main page](https://attack.mitre.org/){:target="_blank"}

[ATTACK Design and Philosophy](https://attack.mitre.org/docs/ATTACK_Design_and_Philosophy_March_2020.pdf){:target="_blank"}

[ATTACK's Blog](https://medium.com/mitre-attack)https://medium.com/mitre-attack){:target="_blank"}.

[Cyber Kill Chain](https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html){:target="_blank"}.

[UKC's main page](https://www.unifiedkillchain.com/){:target="_blank"}.
